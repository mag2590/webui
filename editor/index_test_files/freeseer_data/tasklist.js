function aceInitialized(a,b){var c=b.editorInfo;c.ace_doInsertTaskList=underscore(exports.tasklist.doInsertTaskList).bind(b),c.ace_doToggleTaskListItem=underscore(exports.tasklist.doToggleTaskListItem).bind(b),padEditor=b.editorInfo.editor}if(typeof exports=="undefined")var exports=this.mymodule={};var underscore=require("ep_etherpad-lite/static/js/underscore"),tags=["tasklist-not-done","tasklist-done"],padEditor;exports.tasklist={init:function(a){var b='<li class="acl-write" id="tasklist"><a class="grouped-middle" data-l10n-id="pad.toolbar.tasklist.title" title="Task list Checkbox"><span class="buttonicon buttonicon-tasklist"></span></a></li>';$(b).insertBefore("#indent"),$("#tasklist").click(function(){a.ace.callWithAce(function(a){a.ace_doInsertTaskList()},"tasklist",!0)}),a.ace.callWithAce(function(a){var b=a.ace_getDocument();$(b).find("#innerdocbody").on("click",underscore(exports.tasklist.doUpdateTaskList).bind(a))},"tasklist",!0)},doInsertTaskList:function(){var a=this.rep,b=this.documentAttributeManager;if(!a.selStart||!a.selEnd)return;var c=a.selStart[0],d=Math.max(c,a.selEnd[0]-(a.selEnd[1]===0?1:0));underscore(underscore.range(c,d+1)).each(function(a){var c=b.getAttributeOnLine(a,"tasklist-not-done");c?b.removeAttributeOnLine(a,"tasklist-not-done"):b.setAttributeOnLine(a,"tasklist-not-done","tasklist-not-done")})},doToggleTaskListItem:function(){var a=this.rep,b=this.documentAttributeManager,c=b.getAttributeOnLine(a.selEnd[0],"tasklist-done");c?(b.removeAttributeOnLine(a.selEnd[0],"tasklist-done"),b.setAttributeOnLine(a.selEnd[0],"tasklist-not-done","tasklist-not-done")):(b.removeAttributeOnLine(a.selEnd[0],"tasklist-not-done"),b.setAttributeOnLine(a.selEnd[0],"tasklist-done","tasklist-done"))},doUpdateTaskList:function(a){var b=this,c=a.target,d=$(c).hasClass("tasklist-not-done")||$(c).hasClass("tasklist-done"),e=a.target.offsetLeft+14,f=a.pageX<e;if(!d||!f)return;padEditor.callWithAce(function(a){a.ace_doToggleTaskListItem()},"tasklist",!0)}};var aceDomLineProcessLineAttributes=function(a,b){if(b.cls.indexOf("tasklist-not-done")!==-1)var c="tasklist-not-done";if(b.cls.indexOf("tasklist-done")!==-1)var c="tasklist-done";var d=b.cls.indexOf(c);if(d!==undefined&&c){var e=tags[d],f={preHtml:'<li class="'+c+'"">',postHtml:"</li>",processedMarker:!0};return[f]}return[]};exports.aceAttribsToClasses=function(a,b){if(b.key=="tasklist-not-done"||b.key=="tasklist-done")return[b.value]},exports.aceInitialized=aceInitialized,exports.aceDomLineProcessLineAttributes=aceDomLineProcessLineAttributes,exports.aceEditorCSS=function(a,b){return["/ep_tasklist/static/css/tasklist.css"]},exports.postAceInit=function(a,b){exports.tasklist.init(b)}